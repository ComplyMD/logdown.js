(function(){function e(t,r){return this instanceof e?e._isPrefixAlreadyInUse(t)?e._getInstanceByPrefix(t):(this.opts=e._normalizeOpts(t,r),this.state=e._getInitialState(this.opts),e._instances.push(this),this):new e(t,r)}function t(e){return a.Array.prototype.slice.call(e,0)}function r(){try{return"WebkitAppearance"in a.document.documentElement.style}catch(e){return!1}}function n(){try{return navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)}catch(e){return!1}}function o(){return r()||n()}function i(e,t){var r=[];return t.forEach(function(t){var n=e.match(t.regexp);n&&r.push({rule:t,match:n})}),0===r.length?null:(r.sort(function(e,t){return e.match.index-t.match.index}),r[0])}var s=Array(1),a=this,p=e.prototype;e._instances=[],e._prefixRegExps=[],e._prepareRegExpForPrefixSearch=function(e){return new a.RegExp("^"+e.replace(/\*/g,".*?")+"$")},e._isPrefixAlreadyInUse=function(t){return e._instances.some(function(e){return e.opts.prefix===t})},e._getInstanceByPrefix=function(t){return e._instances.filter(function(e){return e.opts.prefix===t})[0]},e._normalizeOpts=function(t,r){if("string"!=typeof t)throw new a.TypeError("prefix must be a string");var n=void 0===(r=r||{}).markdown||a.Boolean(r.markdown);return{prefix:t,prefixColor:r.prefixColor||e._getNextPrefixColor(),markdown:n}},e._getInitialState=function(t){return{isEnabled:e._getEnableState(t)}},e._getEnableState=function(t){var r=!1;return e._prefixRegExps.forEach(function(e){"enable"===e.type&&e.regExp.test(t.prefix)?r=!0:"disable"===e.type&&e.regExp.test(t.prefix)&&(r=!1)}),r},e.prefixColors=["#F2777A","#F99157","#FFCC66","#99CC99","#66CCCC","#6699CC","#CC99CC"];var c=this;e._setPrefixRegExps=function(){try{c.localStorage&&"string"==typeof c.localStorage.getItem("debug")&&(e._prefixRegExps=[],c.localStorage.getItem("debug").split(",").forEach(function(t){var r="enable";"-"===(t=t.trim())[0]&&(t=t.substr(1),r="disable");var n=e._prepareRegExpForPrefixSearch(t);e._prefixRegExps.push({type:r,regExp:n})}))}catch(e){}},e._getNextPrefixColor=function(){return s[0]||(s[0]={lastUsed:0}),s[0].lastUsed+=1,e.prefixColors[s[0].lastUsed%e.prefixColors.length]};var l=[{regexp:/\*([^*]+)\*/,replacer:function(e,t){return"%c"+t+"%c"},style:"font-weight:bold;"},{regexp:/_([^_]+)_/,replacer:function(e,t){return"%c"+t+"%c"},style:"font-style:italic;"},{regexp:/`([^`]+)`/,replacer:function(e,t){return"%c"+t+"%c"},style:"background-color:rgba(255,204,102, 0.1);color:#FFCC66;padding:2px 5px;border-radius:2px;"}],u={parse:function(e){for(var t=[],r=i(e,l);r;)t.push(r.rule.style),t.push(""),r=i(e=e.replace(r.rule.regexp,r.rule.replacer),l);return{text:e,styles:t}}};p._prepareOutput=function(e){var t,r=this._getDecoratedPrefix();return"string"==typeof e[0]?this.opts.markdown&&o()?(t=u.parse(e[0]),r[0]=r[0]+t.text,r=r.concat(t.styles)):r[0]=r[0]+e[0]:r.push(e[0]),e.length>1&&(r=r.concat(e.slice(1))),r},p._getDecoratedPrefix=function(){var e=[];return o()?(e.push("%c"+this.opts.prefix+"%c "),e.push("color:"+this.opts.prefixColor+"; font-weight:bold;","")):e.push("["+this.opts.prefix+"] "),e},p.error=function(){if(this.state.isEnabled){var e=t(arguments),r=this._prepareOutput(e,"error");(a.console.error||a.console.log).apply(a.console,r)}},p.warn=function(){if(this.state.isEnabled){var e=t(arguments),r=this._prepareOutput(e,"warn");(a.console.warn||a.console.log).apply(a.console,r)}},p.info=function(){if(this.state.isEnabled){var e=t(arguments),r=this._prepareOutput(e,"info");(a.console.info||a.console.log).apply(a.console,r)}},p.log=function(){if(this.state.isEnabled){var e=t(arguments),r=this._prepareOutput(e,"log");(a.console.log||a.console.log).apply(a.console,r)}},p.debug=function(){if(this.state.isEnabled){var e=t(arguments),r=this._prepareOutput(e,"debug");(a.console.debug||a.console.log).apply(a.console,r)}},logdown=e}).call(this);
